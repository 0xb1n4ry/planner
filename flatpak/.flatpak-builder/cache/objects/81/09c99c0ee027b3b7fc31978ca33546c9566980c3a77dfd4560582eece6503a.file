/* Daemon.c generated by valac 0.40.11, the Vala compiler
 * generated from Daemon.vala, do not modify */

/**/
/*  Copyright (C) 2014 Corentin NoÃ«l*/
/**/
/*  This program is free software: you can redistribute it and/or modify*/
/*  it under the terms of the GNU General Public License as published by*/
/*  the Free Software Foundation, either version 3 of the License, or*/
/*  (at your option) any later version.*/
/**/
/*  This program is distributed in the hope that it will be useful,*/
/*  but WITHOUT ANY WARRANTY; without even the implied warranty of*/
/*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the*/
/*  GNU General Public License for more details.*/
/**/
/*  You should have received a copy of the GNU General Public License*/
/*  along with this program.  If not, see <http://www.gnu.org/licenses/>.*/
/**/


#include <glib.h>
#include <glib-object.h>
#include <glib/gi18n-lib.h>
#include <gee.h>
#include <libecal/libecal.h>
#include <signal.h>
#include "elementary-calendar.h"
#include <granite.h>
#include <libedataserver/libedataserver.h>
#include <libical/ical.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>
#include <gio/gio.h>
#include <libnotify/notify.h>

#define _g_option_context_free0(var) ((var == NULL) ? NULL : (var = (g_option_context_free (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _g_main_loop_unref0(var) ((var == NULL) ? NULL : (var = (g_main_loop_unref (var), NULL)))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_date_time_unref0(var) ((var == NULL) ? NULL : (var = (g_date_time_unref (var), NULL)))
typedef struct _Block1Data Block1Data;
typedef struct _Block2Data Block2Data;
typedef struct _Block3Data Block3Data;
#define _g_free0(var) (var = (g_free (var), NULL))
#define _e_cal_component_alarm_free0(var) ((var == NULL) ? NULL : (var = (e_cal_component_alarm_free (var), NULL)))
typedef struct _Block4Data Block4Data;
typedef struct _MayaDaemonAddTimeoutData MayaDaemonAddTimeoutData;

struct _Block1Data {
	int _ref_count_;
	ESource* source;
	GeeCollection* events;
};

struct _Block2Data {
	int _ref_count_;
	ESource* source;
	GeeCollection* events;
};

struct _Block3Data {
	int _ref_count_;
	ESource* source;
	GeeCollection* events;
};

struct _Block4Data {
	int _ref_count_;
	gchar* uid;
	ESource* source;
	ECalComponent* event;
	gpointer _async_data_;
};

struct _MayaDaemonAddTimeoutData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	GAsyncReadyCallback _callback_;
	gboolean _task_complete_;
	ESource* source;
	ECalComponent* event;
	guint interval;
	Block4Data* _data4_;
	gchar* _tmp0_;
	GeeHashMap* _tmp1_;
};


extern gboolean maya_daemon_has_debug;
extern gboolean maya_daemon_has_version;
extern GMainLoop* maya_daemon_mainloop;
GMainLoop* maya_daemon_mainloop = NULL;
gboolean maya_daemon_has_debug = FALSE;
gboolean maya_daemon_has_version = FALSE;
extern GeeHashMap* maya_daemon_event_uid;
GeeHashMap* maya_daemon_event_uid = NULL;

void maya_daemon_on_exit (gint signum);
gint maya_daemon_main (gchar** args,
                       int args_length1);
static void _maya_daemon_on_exit_gsignal_handler_func (gint signum);
void maya_daemon_load_today_events (void);
static gboolean __lambda8_ (void);
static gboolean ___lambda8__gsource_func (gpointer self);
void maya_daemon_on_events_added (ESource* source,
                                  GeeCollection* events);
static void _maya_daemon_on_events_added_maya_model_calendar_model_events_added (MayaModelCalendarModel* _sender,
                                                                          ESource* source,
                                                                          GeeCollection* events,
                                                                          gpointer self);
void maya_daemon_on_events_updated (ESource* source,
                                    GeeCollection* events);
static void _maya_daemon_on_events_updated_maya_model_calendar_model_events_updated (MayaModelCalendarModel* _sender,
                                                                              ESource* source,
                                                                              GeeCollection* events,
                                                                              gpointer self);
void maya_daemon_on_events_removed (ESource* source,
                                    GeeCollection* events);
static void _maya_daemon_on_events_removed_maya_model_calendar_model_events_removed (MayaModelCalendarModel* _sender,
                                                                              ESource* source,
                                                                              GeeCollection* events,
                                                                              gpointer self);
static Block1Data* block1_data_ref (Block1Data* _data1_);
static void block1_data_unref (void * _userdata_);
static gboolean __lambda4_ (Block1Data* _data1_);
void maya_daemon_add_event (ESource* source,
                            ECalComponent* event);
static gboolean ___lambda4__gsource_func (gpointer self);
static Block2Data* block2_data_ref (Block2Data* _data2_);
static void block2_data_unref (void * _userdata_);
static gboolean __lambda6_ (Block2Data* _data2_);
void maya_daemon_update_event (ESource* source,
                               ECalComponent* event);
static gboolean ___lambda6__gsource_func (gpointer self);
static Block3Data* block3_data_ref (Block3Data* _data3_);
static void block3_data_unref (void * _userdata_);
static gboolean __lambda7_ (Block3Data* _data3_);
void maya_daemon_remove_event (ESource* source,
                               ECalComponent* event);
static gboolean ___lambda7__gsource_func (gpointer self);
GTimeSpan maya_daemon_time_until_now (GDateTime* dt);
void maya_daemon_add_timeout (ESource* source,
                              ECalComponent* event,
                              guint interval,
                              GAsyncReadyCallback _callback_,
                              gpointer _user_data_);
void maya_daemon_add_timeout_finish (GAsyncResult* _res_);
static void _g_free0_ (gpointer var);
static inline void _g_list_free__g_free0_ (GList* self);
static void maya_daemon_add_timeout_data_free (gpointer _data);
static void maya_daemon_add_timeout_async_ready_wrapper (GObject *source_object,
                                                  GAsyncResult *res,
                                                  void *user_data);
static gboolean maya_daemon_add_timeout_co (MayaDaemonAddTimeoutData* _data_);
static Block4Data* block4_data_ref (Block4Data* _data4_);
static void block4_data_unref (void * _userdata_);
static gboolean __lambda5_ (Block4Data* _data4_);
void maya_daemon_queue_event_notification (ECalComponent* event,
                                           const gchar* uid,
                                           gboolean missed);
static gboolean ___lambda5__gsource_func (gpointer self);

const GOptionEntry MAYA_DAEMON_options[3] = {{"debug", 'd', 0, G_OPTION_ARG_NONE, &maya_daemon_has_debug, N_ ("Print debug information"), NULL}, {"version", (gchar) 0, 0, G_OPTION_ARG_NONE, &maya_daemon_has_version, N_ ("Print version info and exit"), NULL}, {NULL}};

void
maya_daemon_on_exit (gint signum)
{
	GMainLoop* _tmp0_;
#line 32 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_debug ("Daemon.vala:32: Exiting");
#line 33 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = maya_daemon_mainloop;
#line 33 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_main_loop_quit (_tmp0_);
#line 181 "Daemon.c"
}


static void
_maya_daemon_on_exit_gsignal_handler_func (gint signum)
{
#line 38 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_on_exit (signum);
#line 190 "Daemon.c"
}


static gboolean
__lambda8_ (void)
{
	gboolean result = FALSE;
	GeeHashMap* _tmp0_;
#line 68 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = maya_daemon_event_uid;
#line 68 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	gee_abstract_map_clear ((GeeAbstractMap*) _tmp0_);
#line 69 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_load_today_events ();
#line 70 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	result = TRUE;
#line 70 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 209 "Daemon.c"
}


static gboolean
___lambda8__gsource_func (gpointer self)
{
	gboolean result;
	result = __lambda8_ ();
#line 67 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 220 "Daemon.c"
}


gint
maya_daemon_main (gchar** args,
                  int args_length1)
{
	gint result = 0;
	GOptionContext* context = NULL;
	GOptionContext* _tmp0_;
	gboolean _tmp4_;
	GraniteServicesLogLevel _tmp5_;
	GraniteServicesLogLevel _tmp6_;
	gboolean _tmp7_;
	GMainLoop* _tmp10_;
	GMainLoop* _tmp11_;
	GError * _inner_error_ = NULL;
#line 38 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	signal (SIGINT, _maya_daemon_on_exit_gsignal_handler_func);
#line 39 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	signal (SIGTERM, _maya_daemon_on_exit_gsignal_handler_func);
#line 41 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = g_option_context_new ("");
#line 41 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	context = _tmp0_;
#line 42 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_option_context_add_main_entries (context, MAYA_DAEMON_options, NULL);
#line 248 "Daemon.c"
	{
#line 45 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_option_context_parse (context, &args_length1, &args, &_inner_error_);
#line 45 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 254 "Daemon.c"
			gint _tmp1_ = -1;
#line 45 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			if (_inner_error_->domain == G_OPTION_ERROR) {
#line 258 "Daemon.c"
				goto __catch0_g_option_error;
			}
#line 45 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_g_option_context_free0 (context);
#line 45 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 45 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			g_clear_error (&_inner_error_);
#line 45 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			return _tmp1_;
#line 269 "Daemon.c"
		}
	}
	goto __finally0;
	__catch0_g_option_error:
	{
		GError* e = NULL;
		const gchar* _tmp2_;
#line 44 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		e = _inner_error_;
#line 44 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_inner_error_ = NULL;
#line 47 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp2_ = e->message;
#line 47 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_error ("Daemon.vala:47: %s", _tmp2_);
#line 44 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_error_free0 (e);
#line 287 "Daemon.c"
	}
	__finally0:
#line 44 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 292 "Daemon.c"
		gint _tmp3_ = -1;
#line 44 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_option_context_free0 (context);
#line 44 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 44 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_clear_error (&_inner_error_);
#line 44 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		return _tmp3_;
#line 302 "Daemon.c"
	}
#line 50 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp4_ = maya_daemon_has_version;
#line 50 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (_tmp4_) {
#line 51 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_message ("Daemon.vala:51: %s (Daemon)", BUILD_APP_NAME);
#line 52 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_message ("Daemon.vala:52: %s", BUILD_VERSION);
#line 53 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		result = 0;
#line 53 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_option_context_free0 (context);
#line 53 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		return result;
#line 318 "Daemon.c"
	}
#line 56 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	granite_services_logger_initialize (BUILD_APP_NAME);
#line 57 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp5_ = granite_services_logger_get_DisplayLevel ();
#line 57 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp6_ = _tmp5_;
#line 57 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	granite_services_logger_set_DisplayLevel (GRANITE_SERVICES_LOG_LEVEL_WARN);
#line 59 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp7_ = maya_daemon_has_debug;
#line 59 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (_tmp7_) {
#line 332 "Daemon.c"
		GraniteServicesLogLevel _tmp8_;
		GraniteServicesLogLevel _tmp9_;
#line 60 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp8_ = granite_services_logger_get_DisplayLevel ();
#line 60 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp9_ = _tmp8_;
#line 60 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		granite_services_logger_set_DisplayLevel (GRANITE_SERVICES_LOG_LEVEL_DEBUG);
#line 341 "Daemon.c"
	}
#line 64 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp10_ = g_main_loop_new (NULL, FALSE);
#line 64 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_main_loop_unref0 (maya_daemon_mainloop);
#line 64 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_mainloop = _tmp10_;
#line 65 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_load_today_events ();
#line 67 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_timeout_add_seconds_full (G_PRIORITY_DEFAULT, (guint) 86400, ___lambda8__gsource_func, NULL, NULL);
#line 74 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp11_ = maya_daemon_mainloop;
#line 74 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_main_loop_run (_tmp11_);
#line 75 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	result = 0;
#line 75 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_option_context_free0 (context);
#line 75 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 363 "Daemon.c"
}


int
main (int argc,
      char ** argv)
{
#line 36 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return maya_daemon_main (argv, argc);
#line 373 "Daemon.c"
}


static void
_maya_daemon_on_events_added_maya_model_calendar_model_events_added (MayaModelCalendarModel* _sender,
                                                                     ESource* source,
                                                                     GeeCollection* events,
                                                                     gpointer self)
{
#line 81 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_on_events_added (source, events);
#line 385 "Daemon.c"
}


static void
_maya_daemon_on_events_updated_maya_model_calendar_model_events_updated (MayaModelCalendarModel* _sender,
                                                                         ESource* source,
                                                                         GeeCollection* events,
                                                                         gpointer self)
{
#line 82 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_on_events_updated (source, events);
#line 397 "Daemon.c"
}


static void
_maya_daemon_on_events_removed_maya_model_calendar_model_events_removed (MayaModelCalendarModel* _sender,
                                                                         ESource* source,
                                                                         GeeCollection* events,
                                                                         gpointer self)
{
#line 83 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_on_events_removed (source, events);
#line 409 "Daemon.c"
}


void
maya_daemon_load_today_events (void)
{
	GeeHashMap* _tmp0_;
	MayaModelCalendarModel* model = NULL;
	MayaModelCalendarModel* _tmp1_;
	GDateTime* _tmp2_;
	GDateTime* _tmp3_;
	GDateTime* _tmp4_;
#line 79 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = gee_hash_map_new (e_cal_component_get_type (), (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
#line 79 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (maya_daemon_event_uid);
#line 79 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_event_uid = _tmp0_;
#line 80 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp1_ = maya_model_calendar_model_get_default ();
#line 80 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	model = _tmp1_;
#line 81 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_signal_connect (model, "events-added", (GCallback) _maya_daemon_on_events_added_maya_model_calendar_model_events_added, NULL);
#line 82 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_signal_connect (model, "events-updated", (GCallback) _maya_daemon_on_events_updated_maya_model_calendar_model_events_updated, NULL);
#line 83 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_signal_connect (model, "events-removed", (GCallback) _maya_daemon_on_events_removed_maya_model_calendar_model_events_removed, NULL);
#line 84 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp2_ = g_date_time_new_now_local ();
#line 84 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp3_ = maya_util_get_start_of_month (_tmp2_);
#line 84 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp4_ = _tmp3_;
#line 84 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_model_calendar_model_set_month_start (model, _tmp4_);
#line 84 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_date_time_unref0 (_tmp4_);
#line 78 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (model);
#line 450 "Daemon.c"
}


static gpointer
_g_object_ref0 (gpointer self)
{
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return self ? g_object_ref (self) : NULL;
#line 459 "Daemon.c"
}


static Block1Data*
block1_data_ref (Block1Data* _data1_)
{
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_atomic_int_inc (&_data1_->_ref_count_);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return _data1_;
#line 470 "Daemon.c"
}


static void
block1_data_unref (void * _userdata_)
{
	Block1Data* _data1_;
	_data1_ = (Block1Data*) _userdata_;
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (g_atomic_int_dec_and_test (&_data1_->_ref_count_)) {
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_data1_->source);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_data1_->events);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_slice_free (Block1Data, _data1_);
#line 487 "Daemon.c"
	}
}


static gboolean
__lambda4_ (Block1Data* _data1_)
{
	gboolean result = FALSE;
	{
		GeeIterator* _event_it = NULL;
		GeeIterator* _tmp0_;
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp0_ = gee_iterable_iterator ((GeeIterable*) _data1_->events);
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_event_it = _tmp0_;
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		while (TRUE) {
#line 505 "Daemon.c"
			GeeIterator* _tmp1_;
			ECalComponent* event = NULL;
			GeeIterator* _tmp2_;
			gpointer _tmp3_;
			ECalComponent* _tmp4_;
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp1_ = _event_it;
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			if (!gee_iterator_next (_tmp1_)) {
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				break;
#line 517 "Daemon.c"
			}
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp2_ = _event_it;
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp3_ = gee_iterator_get (_tmp2_);
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			event = (ECalComponent*) _tmp3_;
#line 95 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp4_ = event;
#line 95 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			maya_daemon_add_event (_data1_->source, _tmp4_);
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_g_object_unref0 (event);
#line 531 "Daemon.c"
		}
#line 94 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_event_it);
#line 535 "Daemon.c"
	}
#line 97 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	result = FALSE;
#line 97 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 541 "Daemon.c"
}


static gboolean
___lambda4__gsource_func (gpointer self)
{
	gboolean result;
	result = __lambda4_ (self);
#line 93 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 552 "Daemon.c"
}


void
maya_daemon_on_events_added (ESource* source,
                             GeeCollection* events)
{
	Block1Data* _data1_;
	ESource* _tmp0_;
	GeeCollection* _tmp1_;
	ESourceAlarms* extension = NULL;
	ESourceExtension* _tmp2_;
	ESourceAlarms* _tmp3_;
	ESourceAlarms* _tmp4_;
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (source != NULL);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (events != NULL);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data1_ = g_slice_new0 (Block1Data);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data1_->_ref_count_ = 1;
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = _g_object_ref0 (source);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (_data1_->source);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data1_->source = _tmp0_;
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp1_ = _g_object_ref0 (events);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (_data1_->events);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data1_->events = _tmp1_;
#line 88 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp2_ = e_source_get_extension (_data1_->source, E_SOURCE_EXTENSION_ALARMS);
#line 88 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp3_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp2_, e_source_alarms_get_type (), ESourceAlarms));
#line 88 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	extension = _tmp3_;
#line 89 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp4_ = extension;
#line 89 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (e_source_alarms_get_include_me (_tmp4_) == FALSE) {
#line 90 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (extension);
#line 90 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		block1_data_unref (_data1_);
#line 90 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_data1_ = NULL;
#line 90 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		return;
#line 605 "Daemon.c"
	}
#line 93 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ___lambda4__gsource_func, block1_data_ref (_data1_), block1_data_unref);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (extension);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	block1_data_unref (_data1_);
#line 87 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data1_ = NULL;
#line 615 "Daemon.c"
}


static Block2Data*
block2_data_ref (Block2Data* _data2_)
{
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_atomic_int_inc (&_data2_->_ref_count_);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return _data2_;
#line 626 "Daemon.c"
}


static void
block2_data_unref (void * _userdata_)
{
	Block2Data* _data2_;
	_data2_ = (Block2Data*) _userdata_;
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (g_atomic_int_dec_and_test (&_data2_->_ref_count_)) {
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_data2_->source);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_data2_->events);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_slice_free (Block2Data, _data2_);
#line 643 "Daemon.c"
	}
}


static gboolean
__lambda6_ (Block2Data* _data2_)
{
	gboolean result = FALSE;
	{
		GeeIterator* _event_it = NULL;
		GeeIterator* _tmp0_;
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp0_ = gee_iterable_iterator ((GeeIterable*) _data2_->events);
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_event_it = _tmp0_;
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		while (TRUE) {
#line 661 "Daemon.c"
			GeeIterator* _tmp1_;
			ECalComponent* event = NULL;
			GeeIterator* _tmp2_;
			gpointer _tmp3_;
			ECalComponent* _tmp4_;
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp1_ = _event_it;
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			if (!gee_iterator_next (_tmp1_)) {
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				break;
#line 673 "Daemon.c"
			}
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp2_ = _event_it;
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp3_ = gee_iterator_get (_tmp2_);
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			event = (ECalComponent*) _tmp3_;
#line 104 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp4_ = event;
#line 104 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			maya_daemon_update_event (_data2_->source, _tmp4_);
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_g_object_unref0 (event);
#line 687 "Daemon.c"
		}
#line 103 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_event_it);
#line 691 "Daemon.c"
	}
#line 106 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	result = FALSE;
#line 106 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 697 "Daemon.c"
}


static gboolean
___lambda6__gsource_func (gpointer self)
{
	gboolean result;
	result = __lambda6_ (self);
#line 102 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 708 "Daemon.c"
}


void
maya_daemon_on_events_updated (ESource* source,
                               GeeCollection* events)
{
	Block2Data* _data2_;
	ESource* _tmp0_;
	GeeCollection* _tmp1_;
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (source != NULL);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (events != NULL);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data2_ = g_slice_new0 (Block2Data);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data2_->_ref_count_ = 1;
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = _g_object_ref0 (source);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (_data2_->source);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data2_->source = _tmp0_;
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp1_ = _g_object_ref0 (events);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (_data2_->events);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data2_->events = _tmp1_;
#line 102 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ___lambda6__gsource_func, block2_data_ref (_data2_), block2_data_unref);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	block2_data_unref (_data2_);
#line 101 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data2_ = NULL;
#line 745 "Daemon.c"
}


static Block3Data*
block3_data_ref (Block3Data* _data3_)
{
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_atomic_int_inc (&_data3_->_ref_count_);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return _data3_;
#line 756 "Daemon.c"
}


static void
block3_data_unref (void * _userdata_)
{
	Block3Data* _data3_;
	_data3_ = (Block3Data*) _userdata_;
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (g_atomic_int_dec_and_test (&_data3_->_ref_count_)) {
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_data3_->source);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_data3_->events);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_slice_free (Block3Data, _data3_);
#line 773 "Daemon.c"
	}
}


static gboolean
__lambda7_ (Block3Data* _data3_)
{
	gboolean result = FALSE;
	{
		GeeIterator* _event_it = NULL;
		GeeIterator* _tmp0_;
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp0_ = gee_iterable_iterator ((GeeIterable*) _data3_->events);
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_event_it = _tmp0_;
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		while (TRUE) {
#line 791 "Daemon.c"
			GeeIterator* _tmp1_;
			ECalComponent* event = NULL;
			GeeIterator* _tmp2_;
			gpointer _tmp3_;
			ECalComponent* _tmp4_;
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp1_ = _event_it;
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			if (!gee_iterator_next (_tmp1_)) {
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				break;
#line 803 "Daemon.c"
			}
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp2_ = _event_it;
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp3_ = gee_iterator_get (_tmp2_);
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			event = (ECalComponent*) _tmp3_;
#line 113 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp4_ = event;
#line 113 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			maya_daemon_remove_event (_data3_->source, _tmp4_);
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_g_object_unref0 (event);
#line 817 "Daemon.c"
		}
#line 112 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_event_it);
#line 821 "Daemon.c"
	}
#line 115 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	result = FALSE;
#line 115 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 827 "Daemon.c"
}


static gboolean
___lambda7__gsource_func (gpointer self)
{
	gboolean result;
	result = __lambda7_ (self);
#line 111 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 838 "Daemon.c"
}


void
maya_daemon_on_events_removed (ESource* source,
                               GeeCollection* events)
{
	Block3Data* _data3_;
	ESource* _tmp0_;
	GeeCollection* _tmp1_;
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (source != NULL);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (events != NULL);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data3_ = g_slice_new0 (Block3Data);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data3_->_ref_count_ = 1;
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = _g_object_ref0 (source);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (_data3_->source);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data3_->source = _tmp0_;
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp1_ = _g_object_ref0 (events);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (_data3_->events);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data3_->events = _tmp1_;
#line 111 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ___lambda7__gsource_func, block3_data_ref (_data3_), block3_data_unref);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	block3_data_unref (_data3_);
#line 110 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data3_ = NULL;
#line 875 "Daemon.c"
}


static void
_g_free0_ (gpointer var)
{
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	var = (g_free (var), NULL);
#line 884 "Daemon.c"
}


static inline void
_g_list_free__g_free0_ (GList* self)
{
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_list_free_full (self, (GDestroyNotify) _g_free0_);
#line 893 "Daemon.c"
}


void
maya_daemon_add_event (ESource* source,
                       ECalComponent* event)
{
	icalcomponent* comp = NULL;
	icalcomponent* _tmp0_;
	icalcomponent* _tmp1_;
	const gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_;
	icalcomponent* _tmp5_;
	const gchar* _tmp6_;
	gchar* _tmp7_;
	gchar* _tmp8_;
	GList* _tmp9_;
#line 119 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (source != NULL);
#line 119 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (event != NULL);
#line 120 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = e_cal_component_get_icalcomponent (event);
#line 120 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	comp = _tmp0_;
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp1_ = comp;
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp2_ = icalcomponent_get_summary (_tmp1_);
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp3_ = e_source_dup_display_name (source);
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp4_ = _tmp3_;
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp5_ = comp;
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp6_ = icalcomponent_get_uid (_tmp5_);
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp7_ = g_strdup_printf ("Event [%s, %s, %s]", _tmp2_, _tmp4_, _tmp6_);
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp8_ = _tmp7_;
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_debug ("Daemon.vala:121: %s", _tmp8_);
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_free0 (_tmp8_);
#line 121 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_free0 (_tmp4_);
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp9_ = e_cal_component_get_alarm_uids (event);
#line 944 "Daemon.c"
	{
		GList* alarm_uid_collection = NULL;
		GList* alarm_uid_it = NULL;
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		alarm_uid_collection = _tmp9_;
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		for (alarm_uid_it = alarm_uid_collection; alarm_uid_it != NULL; alarm_uid_it = alarm_uid_it->next) {
#line 952 "Daemon.c"
			gchar* _tmp10_;
			gchar* alarm_uid = NULL;
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp10_ = g_strdup ((const gchar*) alarm_uid_it->data);
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			alarm_uid = _tmp10_;
#line 959 "Daemon.c"
			{
				ECalComponentAlarm* e_alarm = NULL;
				const gchar* _tmp11_;
				ECalComponentAlarm* _tmp12_;
				ECalComponentAlarmAction action = 0;
				ECalComponentAlarm* _tmp13_;
				ECalComponentAlarmAction _tmp14_ = 0;
				ECalComponentAlarmAction _tmp15_;
#line 123 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				_tmp11_ = alarm_uid;
#line 123 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				_tmp12_ = e_cal_component_get_alarm (event, _tmp11_);
#line 123 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				e_alarm = _tmp12_;
#line 125 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				_tmp13_ = e_alarm;
#line 125 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				e_cal_component_alarm_get_action (_tmp13_, &_tmp14_);
#line 125 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				action = _tmp14_;
#line 126 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				_tmp15_ = action;
#line 126 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				switch (_tmp15_) {
#line 126 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
					case E_CAL_COMPONENT_ALARM_DISPLAY:
#line 986 "Daemon.c"
					{
						ECalComponentAlarmTrigger trigger = {0};
						ECalComponentAlarm* _tmp16_;
						ECalComponentAlarmTrigger _tmp17_ = {0};
						ECalComponentAlarmTrigger _tmp18_;
						ECalComponentAlarmTriggerType _tmp19_;
#line 129 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
						_tmp16_ = e_alarm;
#line 129 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
						e_cal_component_alarm_get_trigger (_tmp16_, &_tmp17_);
#line 129 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
						trigger = _tmp17_;
#line 130 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
						_tmp18_ = trigger;
#line 130 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
						_tmp19_ = _tmp18_.type;
#line 130 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
						if (_tmp19_ == E_CAL_COMPONENT_ALARM_TRIGGER_RELATIVE_START) {
#line 1005 "Daemon.c"
							struct icaldurationtype duration = {0};
							ECalComponentAlarmTrigger _tmp20_;
							struct icaldurationtype _tmp21_;
							GDateTime* start_time = NULL;
							icalcomponent* _tmp22_;
							GDateTime* _tmp23_;
							GDateTime* now = NULL;
							GDateTime* _tmp24_;
							GDateTime* _tmp25_;
							GDateTime* _tmp26_;
							GDateTime* _tmp27_;
							struct icaldurationtype _tmp28_;
							guint _tmp29_;
							GDateTime* _tmp30_;
							GDateTime* _tmp31_;
							struct icaldurationtype _tmp32_;
							guint _tmp33_;
							GDateTime* _tmp34_;
							GDateTime* _tmp35_;
							struct icaldurationtype _tmp36_;
							guint _tmp37_;
							GDateTime* _tmp38_;
							GDateTime* _tmp39_;
							struct icaldurationtype _tmp40_;
							guint _tmp41_;
							GDateTime* _tmp42_;
							GDateTime* _tmp43_;
							struct icaldurationtype _tmp44_;
							guint _tmp45_;
							GDateTime* _tmp46_;
							gboolean _tmp47_ = FALSE;
							GDateTime* _tmp48_;
							GDateTime* _tmp49_;
#line 131 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp20_ = trigger;
#line 131 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp21_ = _tmp20_.u.rel_duration;
#line 131 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							duration = _tmp21_;
#line 132 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp22_ = comp;
#line 132 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp23_ = maya_util_ical_to_date_time (icalcomponent_get_dtstart (_tmp22_));
#line 132 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							start_time = _tmp23_;
#line 133 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp24_ = g_date_time_new_now_local ();
#line 133 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							now = _tmp24_;
#line 134 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp25_ = now;
#line 134 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp26_ = start_time;
#line 134 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							if (g_date_time_compare (_tmp25_, _tmp26_) > 0) {
#line 135 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								_g_date_time_unref0 (now);
#line 135 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								_g_date_time_unref0 (start_time);
#line 135 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								continue;
#line 1067 "Daemon.c"
							}
#line 137 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp27_ = start_time;
#line 137 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp28_ = duration;
#line 137 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp29_ = _tmp28_.weeks;
#line 137 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp30_ = g_date_time_add_weeks (_tmp27_, -((gint) _tmp29_));
#line 137 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_g_date_time_unref0 (start_time);
#line 137 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							start_time = _tmp30_;
#line 138 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp31_ = start_time;
#line 138 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp32_ = duration;
#line 138 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp33_ = _tmp32_.days;
#line 138 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp34_ = g_date_time_add_days (_tmp31_, -((gint) _tmp33_));
#line 138 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_g_date_time_unref0 (start_time);
#line 138 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							start_time = _tmp34_;
#line 139 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp35_ = start_time;
#line 139 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp36_ = duration;
#line 139 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp37_ = _tmp36_.hours;
#line 139 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp38_ = g_date_time_add_hours (_tmp35_, -((gint) _tmp37_));
#line 139 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_g_date_time_unref0 (start_time);
#line 139 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							start_time = _tmp38_;
#line 140 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp39_ = start_time;
#line 140 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp40_ = duration;
#line 140 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp41_ = _tmp40_.minutes;
#line 140 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp42_ = g_date_time_add_minutes (_tmp39_, -((gint) _tmp41_));
#line 140 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_g_date_time_unref0 (start_time);
#line 140 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							start_time = _tmp42_;
#line 141 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp43_ = start_time;
#line 141 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp44_ = duration;
#line 141 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp45_ = _tmp44_.seconds;
#line 141 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp46_ = g_date_time_add_seconds (_tmp43_, (gdouble) (-((gint) _tmp45_)));
#line 141 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_g_date_time_unref0 (start_time);
#line 141 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							start_time = _tmp46_;
#line 142 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp48_ = start_time;
#line 142 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_tmp49_ = now;
#line 142 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							if (g_date_time_get_year (_tmp48_) == g_date_time_get_year (_tmp49_)) {
#line 1135 "Daemon.c"
								GDateTime* _tmp50_;
								GDateTime* _tmp51_;
#line 142 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								_tmp50_ = start_time;
#line 142 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								_tmp51_ = now;
#line 142 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								_tmp47_ = g_date_time_get_day_of_year (_tmp50_) == g_date_time_get_day_of_year (_tmp51_);
#line 1144 "Daemon.c"
							} else {
#line 142 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								_tmp47_ = FALSE;
#line 1148 "Daemon.c"
							}
#line 142 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							if (_tmp47_) {
#line 1152 "Daemon.c"
								GTimeSpan time = 0LL;
								GDateTime* _tmp52_;
								GTimeSpan _tmp53_;
#line 143 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								_tmp52_ = start_time;
#line 143 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								time = maya_daemon_time_until_now (_tmp52_);
#line 144 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								_tmp53_ = time;
#line 144 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
								if (_tmp53_ >= ((GTimeSpan) 0)) {
#line 1164 "Daemon.c"
									GTimeSpan _tmp54_;
#line 145 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
									_tmp54_ = time;
#line 145 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
									maya_daemon_add_timeout (source, event, (guint) _tmp54_, NULL, NULL);
#line 1170 "Daemon.c"
								}
							}
#line 130 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_g_date_time_unref0 (now);
#line 130 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
							_g_date_time_unref0 (start_time);
#line 1177 "Daemon.c"
						}
#line 149 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
						continue;
#line 1181 "Daemon.c"
					}
					default:
					{
#line 151 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
						continue;
#line 1187 "Daemon.c"
					}
				}
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				_e_cal_component_alarm_free0 (e_alarm);
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
				_g_free0 (alarm_uid);
#line 1194 "Daemon.c"
			}
		}
#line 122 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		(alarm_uid_collection == NULL) ? NULL : (alarm_uid_collection = (_g_list_free__g_free0_ (alarm_uid_collection), NULL));
#line 1199 "Daemon.c"
	}
}


static void
maya_daemon_add_timeout_data_free (gpointer _data)
{
	MayaDaemonAddTimeoutData* _data_;
	_data_ = _data;
	g_slice_free (MayaDaemonAddTimeoutData, _data_);
}


static void
maya_daemon_add_timeout_async_ready_wrapper (GObject *source_object,
                                             GAsyncResult *res,
                                             void *user_data)
{
	MayaDaemonAddTimeoutData* _task_data_;
	_task_data_ = g_task_get_task_data (G_TASK (res));
	if (_task_data_->_callback_ != NULL) {
		_task_data_->_callback_ (source_object, res, user_data);
	}
	_task_data_->_task_complete_ = TRUE;
}


void
maya_daemon_add_timeout (ESource* source,
                         ECalComponent* event,
                         guint interval,
                         GAsyncReadyCallback _callback_,
                         gpointer _user_data_)
{
	MayaDaemonAddTimeoutData* _data_;
	ESource* _tmp0_;
	ECalComponent* _tmp1_;
	_data_ = g_slice_new0 (MayaDaemonAddTimeoutData);
	_data_->_callback_ = _callback_;
	_data_->_async_result = g_task_new (NULL, NULL, maya_daemon_add_timeout_async_ready_wrapper, _user_data_);
	if (_callback_ == NULL) {
		_data_->_task_complete_ = TRUE;
	}
	g_task_set_task_data (_data_->_async_result, _data_, maya_daemon_add_timeout_data_free);
	_tmp0_ = _g_object_ref0 (source);
	_g_object_unref0 (_data_->source);
	_data_->source = _tmp0_;
	_tmp1_ = _g_object_ref0 (event);
	_g_object_unref0 (_data_->event);
	_data_->event = _tmp1_;
	_data_->interval = interval;
	maya_daemon_add_timeout_co (_data_);
}


void
maya_daemon_add_timeout_finish (GAsyncResult* _res_)
{
	MayaDaemonAddTimeoutData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
}


static Block4Data*
block4_data_ref (Block4Data* _data4_)
{
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_atomic_int_inc (&_data4_->_ref_count_);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return _data4_;
#line 1270 "Daemon.c"
}


static void
block4_data_unref (void * _userdata_)
{
	Block4Data* _data4_;
	_data4_ = (Block4Data*) _userdata_;
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (g_atomic_int_dec_and_test (&_data4_->_ref_count_)) {
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_free0 (_data4_->uid);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_data4_->source);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (_data4_->event);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_slice_free (Block4Data, _data4_);
#line 1289 "Daemon.c"
	}
}


static gchar*
g_date_time_to_string (GDateTime* self)
{
	gchar* result = NULL;
	gchar* _tmp0_;
#line 3009 "/app/share/vala-0.40/vapi/glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, NULL);
#line 3010 "/app/share/vala-0.40/vapi/glib-2.0.vapi"
	_tmp0_ = g_date_time_format (self, "%FT%H:%M:%S%z");
#line 3010 "/app/share/vala-0.40/vapi/glib-2.0.vapi"
	result = _tmp0_;
#line 3010 "/app/share/vala-0.40/vapi/glib-2.0.vapi"
	return result;
#line 1307 "Daemon.c"
}


static gboolean
__lambda5_ (Block4Data* _data4_)
{
	gboolean result = FALSE;
	ESourceAlarms* extension = NULL;
	ESourceExtension* _tmp0_;
	ESourceAlarms* _tmp1_;
	ESourceAlarms* _tmp2_;
#line 161 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = e_source_get_extension (_data4_->source, E_SOURCE_EXTENSION_ALARMS);
#line 161 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp1_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp0_, e_source_alarms_get_type (), ESourceAlarms));
#line 161 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	extension = _tmp1_;
#line 162 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp2_ = extension;
#line 162 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (_tmp2_ != NULL) {
#line 1329 "Daemon.c"
		ESourceAlarms* _tmp3_;
		GDateTime* _tmp4_;
		GDateTime* _tmp5_;
		gchar* _tmp6_;
		gchar* _tmp7_;
#line 163 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp3_ = extension;
#line 163 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp4_ = g_date_time_new_now_local ();
#line 163 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp5_ = _tmp4_;
#line 163 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp6_ = g_date_time_to_string (_tmp5_);
#line 163 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp7_ = _tmp6_;
#line 163 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		e_source_alarms_set_last_notified (_tmp3_, _tmp7_);
#line 163 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_free0 (_tmp7_);
#line 163 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_date_time_unref0 (_tmp5_);
#line 1351 "Daemon.c"
	}
#line 166 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_queue_event_notification (_data4_->event, _data4_->uid, FALSE);
#line 167 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	result = FALSE;
#line 167 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (extension);
#line 167 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 1361 "Daemon.c"
}


static gboolean
___lambda5__gsource_func (gpointer self)
{
	gboolean result;
	result = __lambda5_ (self);
#line 160 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 1372 "Daemon.c"
}


static gboolean
maya_daemon_add_timeout_co (MayaDaemonAddTimeoutData* _data_)
{
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	switch (_data_->_state_) {
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		case 0:
#line 1383 "Daemon.c"
		goto _state_0;
		default:
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_assert_not_reached ();
#line 1388 "Daemon.c"
	}
	_state_0:
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data_->_data4_ = g_slice_new0 (Block4Data);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data_->_data4_->_ref_count_ = 1;
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (_data_->_data4_->source);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data_->_data4_->source = _data_->source;
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (_data_->_data4_->event);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data_->_data4_->event = _data_->event;
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data_->_data4_->_async_data_ = _data_;
#line 157 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data_->_tmp0_ = g_strdup_printf ("%u-%u", _data_->interval, (guint) g_random_int ());
#line 157 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data_->_data4_->uid = _data_->_tmp0_;
#line 158 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data_->_tmp1_ = maya_daemon_event_uid;
#line 158 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	gee_abstract_map_set ((GeeAbstractMap*) _data_->_tmp1_, _data_->_data4_->event, _data_->_data4_->uid);
#line 159 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_debug ("Daemon.vala:159: adding timeout uid:%s", _data_->_data4_->uid);
#line 160 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_timeout_add_seconds_full (G_PRIORITY_DEFAULT, _data_->interval, ___lambda5__gsource_func, block4_data_ref (_data_->_data4_), block4_data_unref);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	block4_data_unref (_data_->_data4_);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_data_->_data4_ = NULL;
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (_data_->_state_ != 0) {
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		while (_data_->_task_complete_ != TRUE) {
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 1429 "Daemon.c"
		}
	}
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_object_unref (_data_->_async_result);
#line 156 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return FALSE;
#line 1436 "Daemon.c"
}


static gboolean
string_contains (const gchar* self,
                 const gchar* needle)
{
	gboolean result = FALSE;
	gchar* _tmp0_;
#line 1473 "/app/share/vala-0.40/vapi/glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, FALSE);
#line 1473 "/app/share/vala-0.40/vapi/glib-2.0.vapi"
	g_return_val_if_fail (needle != NULL, FALSE);
#line 1474 "/app/share/vala-0.40/vapi/glib-2.0.vapi"
	_tmp0_ = strstr ((gchar*) self, (gchar*) needle);
#line 1474 "/app/share/vala-0.40/vapi/glib-2.0.vapi"
	result = _tmp0_ != NULL;
#line 1474 "/app/share/vala-0.40/vapi/glib-2.0.vapi"
	return result;
#line 1456 "Daemon.c"
}


void
maya_daemon_queue_event_notification (ECalComponent* event,
                                      const gchar* uid,
                                      gboolean missed)
{
	GeeHashMap* _tmp0_;
	GeeCollection* _tmp1_;
	GeeCollection* _tmp2_;
	GeeCollection* _tmp3_;
	gboolean _tmp4_;
	NotifyNotification* notification = NULL;
	icalcomponent* comp = NULL;
	icalcomponent* _tmp5_;
	gchar* primary_text = NULL;
	icalcomponent* _tmp6_;
	const gchar* _tmp7_;
	gchar* _tmp8_;
	GDateTime* start_time = NULL;
	icalcomponent* _tmp9_;
	GDateTime* _tmp10_;
	GDateTime* now = NULL;
	GDateTime* _tmp11_;
	gchar* secondary_text = NULL;
	gchar* _tmp12_;
	GSettings* h24_settings = NULL;
	GSettings* _tmp13_;
	gchar* format = NULL;
	GSettings* _tmp14_;
	gchar* _tmp15_;
	gchar* text = NULL;
	const gchar* _tmp16_;
	gchar* _tmp17_;
	GDateTime* _tmp18_;
	GDateTime* _tmp19_;
	NotifyNotification* _tmp38_;
	NotifyNotification* _tmp49_;
	GError * _inner_error_ = NULL;
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (event != NULL);
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (uid != NULL);
#line 172 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = maya_daemon_event_uid;
#line 172 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp1_ = gee_abstract_map_get_values ((GeeAbstractMap*) _tmp0_);
#line 172 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp2_ = _tmp1_;
#line 172 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp3_ = _tmp2_;
#line 172 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp4_ = gee_collection_contains (_tmp3_, uid) == FALSE;
#line 172 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (_tmp3_);
#line 172 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (_tmp4_) {
#line 173 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		return;
#line 1517 "Daemon.c"
	}
#line 175 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	notification = NULL;
#line 178 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (!notify_is_initted ()) {
#line 179 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		if (!notify_init ("net.launchpad.maya")) {
#line 180 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			g_warning ("Daemon.vala:180: Could not init libnotify");
#line 181 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_g_object_unref0 (notification);
#line 181 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			return;
#line 1531 "Daemon.c"
		}
	}
#line 185 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp5_ = e_cal_component_get_icalcomponent (event);
#line 185 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	comp = _tmp5_;
#line 186 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp6_ = comp;
#line 186 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp7_ = icalcomponent_get_summary (_tmp6_);
#line 186 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp8_ = g_strdup_printf ("%s", _tmp7_);
#line 186 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	primary_text = _tmp8_;
#line 187 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp9_ = comp;
#line 187 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp10_ = maya_util_ical_to_date_time (icalcomponent_get_dtstart (_tmp9_));
#line 187 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	start_time = _tmp10_;
#line 188 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp11_ = g_date_time_new_now_local ();
#line 188 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	now = _tmp11_;
#line 189 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp12_ = g_strdup ("");
#line 189 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	secondary_text = _tmp12_;
#line 190 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp13_ = g_settings_new ("org.gnome.desktop.interface");
#line 190 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	h24_settings = _tmp13_;
#line 191 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp14_ = h24_settings;
#line 191 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp15_ = g_settings_get_string (_tmp14_, "clock-format");
#line 191 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	format = _tmp15_;
#line 192 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp16_ = format;
#line 192 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp17_ = granite_date_time_get_default_time_format (string_contains (_tmp16_, "12h"), FALSE);
#line 192 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	text = _tmp17_;
#line 193 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp18_ = start_time;
#line 193 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp19_ = now;
#line 193 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (g_date_time_get_year (_tmp18_) == g_date_time_get_year (_tmp19_)) {
#line 1582 "Daemon.c"
		GDateTime* _tmp20_;
		GDateTime* _tmp21_;
#line 194 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp20_ = start_time;
#line 194 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp21_ = now;
#line 194 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		if (g_date_time_get_day_of_year (_tmp20_) == g_date_time_get_day_of_year (_tmp21_)) {
#line 1591 "Daemon.c"
			GDateTime* _tmp22_;
			gchar* _tmp23_;
#line 195 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp22_ = start_time;
#line 195 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp23_ = granite_date_time_get_relative_datetime (_tmp22_);
#line 195 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_g_free0 (secondary_text);
#line 195 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			secondary_text = _tmp23_;
#line 1602 "Daemon.c"
		} else {
			GDateTime* _tmp24_;
			gchar* _tmp25_;
			gchar* _tmp26_;
			const gchar* _tmp27_;
			gchar* _tmp28_;
			gchar* _tmp29_;
			gchar* _tmp30_;
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp24_ = start_time;
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp25_ = granite_date_time_get_default_date_format (FALSE, TRUE, FALSE);
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp26_ = _tmp25_;
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp27_ = text;
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp28_ = g_strdup_printf ("%s, %s", _tmp26_, _tmp27_);
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp29_ = _tmp28_;
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_tmp30_ = g_date_time_format (_tmp24_, _tmp29_);
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_g_free0 (secondary_text);
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			secondary_text = _tmp30_;
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_g_free0 (_tmp29_);
#line 197 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
			_g_free0 (_tmp26_);
#line 1633 "Daemon.c"
		}
	} else {
		GDateTime* _tmp31_;
		gchar* _tmp32_;
		gchar* _tmp33_;
		const gchar* _tmp34_;
		gchar* _tmp35_;
		gchar* _tmp36_;
		gchar* _tmp37_;
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp31_ = start_time;
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp32_ = granite_date_time_get_default_date_format (FALSE, TRUE, TRUE);
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp33_ = _tmp32_;
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp34_ = text;
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp35_ = g_strdup_printf ("%s, %s", _tmp33_, _tmp34_);
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp36_ = _tmp35_;
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp37_ = g_date_time_format (_tmp31_, _tmp36_);
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_free0 (secondary_text);
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		secondary_text = _tmp37_;
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_free0 (_tmp36_);
#line 200 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_free0 (_tmp33_);
#line 1665 "Daemon.c"
	}
#line 203 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp38_ = notification;
#line 203 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (_tmp38_ == NULL) {
#line 1671 "Daemon.c"
		const gchar* _tmp39_;
		const gchar* _tmp40_;
		NotifyNotification* _tmp41_;
#line 204 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp39_ = primary_text;
#line 204 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp40_ = secondary_text;
#line 204 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp41_ = notify_notification_new (_tmp39_, _tmp40_, "");
#line 204 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (notification);
#line 204 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		notification = _tmp41_;
#line 1685 "Daemon.c"
	} else {
		NotifyNotification* _tmp42_;
		NotifyNotification* _tmp43_;
		NotifyNotification* _tmp44_;
		const gchar* _tmp45_;
		const gchar* _tmp46_;
#line 206 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp42_ = notification;
#line 206 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		notify_notification_clear_hints (_tmp42_);
#line 207 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp43_ = notification;
#line 207 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		notify_notification_clear_actions (_tmp43_);
#line 208 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp44_ = notification;
#line 208 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp45_ = primary_text;
#line 208 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp46_ = secondary_text;
#line 208 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		notify_notification_update (_tmp44_, _tmp45_, _tmp46_, "");
#line 1708 "Daemon.c"
	}
#line 211 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (missed == FALSE) {
#line 1712 "Daemon.c"
		NotifyNotification* _tmp47_;
#line 212 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp47_ = notification;
#line 212 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_object_set (_tmp47_, "icon-name", "appointment-soon", NULL);
#line 1718 "Daemon.c"
	} else {
		NotifyNotification* _tmp48_;
#line 214 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp48_ = notification;
#line 214 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_object_set (_tmp48_, "icon-name", "appointment-missed", NULL);
#line 1725 "Daemon.c"
	}
#line 217 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp49_ = notification;
#line 217 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	notify_notification_set_urgency (_tmp49_, NOTIFY_URGENCY_NORMAL);
#line 1731 "Daemon.c"
	{
		NotifyNotification* _tmp50_;
#line 220 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp50_ = notification;
#line 220 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		notify_notification_show (_tmp50_, &_inner_error_);
#line 220 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 1740 "Daemon.c"
			goto __catch1_g_error;
		}
	}
	goto __finally1;
	__catch1_g_error:
	{
		GError* err = NULL;
		GError* _tmp51_;
		const gchar* _tmp52_;
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		err = _inner_error_;
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_inner_error_ = NULL;
#line 222 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp51_ = err;
#line 222 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp52_ = _tmp51_->message;
#line 222 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_warning ("Daemon.vala:222: Could not show notification: %s", _tmp52_);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_error_free0 (err);
#line 1762 "Daemon.c"
	}
	__finally1:
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_free0 (text);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_free0 (format);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (h24_settings);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_free0 (secondary_text);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_date_time_unref0 (now);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_date_time_unref0 (start_time);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_free0 (primary_text);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_g_object_unref0 (notification);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		g_clear_error (&_inner_error_);
#line 219 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		return;
#line 1789 "Daemon.c"
	}
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_free0 (text);
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_free0 (format);
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (h24_settings);
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_free0 (secondary_text);
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_date_time_unref0 (now);
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_date_time_unref0 (start_time);
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_free0 (primary_text);
#line 171 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_object_unref0 (notification);
#line 1807 "Daemon.c"
}


void
maya_daemon_update_event (ESource* source,
                          ECalComponent* event)
{
#line 227 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (source != NULL);
#line 227 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (event != NULL);
#line 228 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_remove_event (source, event);
#line 229 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	e_cal_component_rescan (event);
#line 230 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	e_cal_component_commit_sequence (event);
#line 231 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	maya_daemon_add_event (source, event);
#line 1827 "Daemon.c"
}


void
maya_daemon_remove_event (ESource* source,
                          ECalComponent* event)
{
	GeeHashMap* _tmp0_;
#line 234 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (source != NULL);
#line 234 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_if_fail (event != NULL);
#line 235 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = maya_daemon_event_uid;
#line 235 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	if (gee_abstract_map_has_key ((GeeAbstractMap*) _tmp0_, event)) {
#line 1844 "Daemon.c"
		GeeHashMap* _tmp1_;
#line 236 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		_tmp1_ = maya_daemon_event_uid;
#line 236 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
		gee_abstract_map_unset ((GeeAbstractMap*) _tmp1_, event, NULL);
#line 1850 "Daemon.c"
	}
}


GTimeSpan
maya_daemon_time_until_now (GDateTime* dt)
{
	GTimeSpan result = 0LL;
	GDateTime* now = NULL;
	GDateTime* _tmp0_;
#line 240 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	g_return_val_if_fail (dt != NULL, 0LL);
#line 241 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_tmp0_ = g_date_time_new_now_local ();
#line 241 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	now = _tmp0_;
#line 242 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	result = g_date_time_difference (dt, now) / G_TIME_SPAN_SECOND;
#line 242 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	_g_date_time_unref0 (now);
#line 242 "/run/build/io.elementary.calendar/daemon/Daemon.vala"
	return result;
#line 1873 "Daemon.c"
}



